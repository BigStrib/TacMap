<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tactical Command - Scanner Map</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
          crossorigin="">
    
    <!-- Google Fonts - Tactical Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Mapillary JS Viewer -->
    <script src="https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.js"></script>
    <link href="https://unpkg.com/mapillary-js@4.1.1/dist/mapillary.css" rel="stylesheet">
</head>
<body class="tactical-theme">
    
    <!-- ============================================ -->
    <!-- MAIN APPLICATION CONTAINER -->
    <!-- ============================================ -->
    <div id="appContainer" class="app-container">
        
        <!-- ============================================ -->
        <!-- MAP PANEL (Left/Full) -->
        <!-- ============================================ -->
        <div id="mapPanel" class="map-panel">
            <div id="map" class="map-view"></div>
            
            <!-- Max Zoom Warning Overlay -->
            <div id="maxZoomWarning" class="max-zoom-warning hidden">
                <div class="warning-content">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Maximum zoom reached for this layer</span>
                </div>
            </div>
        </div>
        
        <!-- ============================================ -->
        <!-- STREET VIEW PANEL (Right - Hidden by default) -->
        <!-- ============================================ -->
        <div id="streetViewPanel" class="street-view-panel hidden">
            <!-- Street View Header -->
            <div class="street-view-header">
                <div class="street-view-title">
                    <i class="fas fa-street-view"></i>
                    <span>Street View</span>
                </div>
                <div class="street-view-info">
                    <span id="streetViewLocation">--</span>
                </div>
                <button id="closeStreetView" class="tactical-btn btn-close" title="Close Street View">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <!-- Mapillary Viewer Container -->
            <div id="mapillaryViewer" class="mapillary-container"></div>
            
            <!-- Street View Loading -->
            <div id="streetViewLoading" class="street-view-loading hidden">
                <div class="loading-spinner"></div>
                <span>Loading Street View...</span>
            </div>
            
            <!-- Street View No Coverage -->
            <div id="streetViewEmpty" class="street-view-empty hidden">
                <i class="fas fa-eye-slash"></i>
                <span>No street imagery available</span>
            </div>
        </div>
        
        <!-- Resize Handle for Split View -->
        <div id="resizeHandle" class="resize-handle hidden">
            <div class="handle-bar"></div>
        </div>
    </div>
    
    <!-- ============================================ -->
    <!-- ERROR NOTIFICATION (Red Toast for Mapillary) -->
    <!-- ============================================ -->
    <div id="errorNotification" class="error-notification hidden">
        <i class="fas fa-exclamation-circle"></i>
        <span id="errorMessage">No street imagery available at this location</span>
    </div>
    
    <!-- ============================================ -->
    <!-- TACTICAL SEARCH HEADER -->
    <!-- ============================================ -->
    <header class="tactical-header">
        <div class="header-container">
            <!-- Brand/Logo -->
            <div class="tactical-brand">
                <div class="brand-icon">
                    <i class="fas fa-crosshairs"></i>
                </div>
                <div class="brand-text">
                    <span class="brand-title">TACTICAL CMD</span>
                    <span class="brand-subtitle">Scanner Map System</span>
                </div>
            </div>
            
            <!-- Search Container -->
            <div class="search-wrapper">
                <div class="search-input-group">
                    <i class="fas fa-search search-icon"></i>
                    <input 
                        type="text" 
                        id="searchInput" 
                        class="search-input" 
                        placeholder="Enter address, coordinates, or location..."
                        autocomplete="off"
                        spellcheck="false"
                    >
                    <button id="clearSearch" class="tactical-btn btn-icon btn-clear hidden" title="Clear">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="search-divider"></div>
                    <button id="searchBtn" class="tactical-btn btn-primary" title="Search">
                        <i class="fas fa-arrow-right"></i>
                        <span class="btn-text">SEARCH</span>
                    </button>
                </div>
                
                <!-- Search Dropdown Results -->
                <div id="searchDropdown" class="search-dropdown hidden">
                    <div class="dropdown-header">
                        <span>Search Results</span>
                        <span id="resultCount" class="result-count">0 found</span>
                    </div>
                    <ul id="searchResults" class="search-results-list"></ul>
                    <div id="searchLoading" class="search-loading hidden">
                        <div class="loading-spinner small"></div>
                        <span>Searching multiple providers...</span>
                    </div>
                    <div id="searchError" class="search-error hidden">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>No results found. Try a different search.</span>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="header-actions">
                <button id="myLocationBtn" class="tactical-btn btn-icon" title="My Location [L]">
                    <i class="fas fa-crosshairs"></i>
                </button>
                <button id="streetViewBtn" class="tactical-btn btn-icon" title="Street View [V]">
                    <i class="fas fa-street-view"></i>
                </button>
            </div>
        </div>
    </header>
    
    <!-- ============================================ -->
    <!-- MAP CONTROL PANEL (Right Side) -->
    <!-- ============================================ -->
    <aside class="control-panel">
        <!-- Zoom Controls -->
        <div class="control-group">
            <span class="control-label">ZOOM</span>
            <button id="zoomIn" class="tactical-btn btn-control" title="Zoom In [+]">
                <i class="fas fa-plus"></i>
            </button>
            <button id="zoomOut" class="tactical-btn btn-control" title="Zoom Out [-]">
                <i class="fas fa-minus"></i>
            </button>
        </div>
        
        <!-- View Controls -->
        <div class="control-group">
            <span class="control-label">VIEW</span>
            <button id="homeBtn" class="tactical-btn btn-control" title="Home Base [H]">
                <i class="fas fa-home"></i>
            </button>
            <button id="rotateBtn" class="tactical-btn btn-control" title="Reset Rotation [R]">
                <i class="fas fa-compass"></i>
            </button>
        </div>
        
        <!-- Layer Controls -->
        <div class="control-group">
            <span class="control-label">LAYERS</span>
            <button id="layerBtn" class="tactical-btn btn-control" title="Map Layers [M]">
                <i class="fas fa-layer-group"></i>
            </button>
        </div>
    </aside>
    
    <!-- ============================================ -->
    <!-- MAP LAYER SELECTOR PANEL -->
    <!-- ============================================ -->
    <div id="layerPanel" class="layer-panel hidden">
        <div class="panel-header">
            <span class="panel-title">
                <i class="fas fa-layer-group"></i>
                MAP LAYERS
            </span>
            <button id="closeLayerPanel" class="tactical-btn btn-close" title="Close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="layer-options">
            <!-- Base Layers -->
            <div class="layer-section">
                <span class="section-title">BASE MAP</span>
                
                <button class="layer-option" data-layer="satellite" data-active="false">
                    <div class="layer-preview satellite-preview">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='40'%3E%3Crect fill='%231a4301' width='60' height='40'/%3E%3Crect fill='%232d5016' x='10' y='5' width='15' height='12'/%3E%3Crect fill='%233a6b1e' x='35' y='20' width='20' height='15'/%3E%3C/svg%3E" alt="Satellite">
                    </div>
                    <div class="layer-info">
                        <span class="layer-name">Satellite HD</span>
                        <span class="layer-desc">High-res aerial imagery with labels</span>
                    </div>
                    <span class="layer-check">
                        <i class="fas fa-check"></i>
                    </span>
                </button>
                
                <button class="layer-option active" data-layer="streets" data-active="true">
                    <div class="layer-preview streets-preview">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='40'%3E%3Crect fill='%23f0f0f0' width='60' height='40'/%3E%3Cline stroke='%23999' stroke-width='2' x1='0' y1='20' x2='60' y2='20'/%3E%3Cline stroke='%23999' stroke-width='2' x1='30' y1='0' x2='30' y2='40'/%3E%3C/svg%3E" alt="Streets">
                    </div>
                    <div class="layer-info">
                        <span class="layer-name">Streets</span>
                        <span class="layer-desc">Standard road map with POIs</span>
                    </div>
                    <span class="layer-check">
                        <i class="fas fa-check"></i>
                    </span>
                </button>
                
                <button class="layer-option" data-layer="dark" data-active="false">
                    <div class="layer-preview dark-preview">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='40'%3E%3Crect fill='%231a1a2e' width='60' height='40'/%3E%3Cline stroke='%23333' stroke-width='2' x1='0' y1='20' x2='60' y2='20'/%3E%3Cline stroke='%23333' stroke-width='2' x1='30' y1='0' x2='30' y2='40'/%3E%3C/svg%3E" alt="Dark">
                    </div>
                    <div class="layer-info">
                        <span class="layer-name">Dark Tactical</span>
                        <span class="layer-desc">Low-light mode for night ops</span>
                    </div>
                    <span class="layer-check">
                        <i class="fas fa-check"></i>
                    </span>
                </button>
                
                <button class="layer-option" data-layer="hybrid" data-active="false">
                    <div class="layer-preview hybrid-preview">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='40'%3E%3Crect fill='%232d5016' width='60' height='40'/%3E%3Cline stroke='%23fff' stroke-width='1' x1='0' y1='20' x2='60' y2='20'/%3E%3Cline stroke='%23fff' stroke-width='1' x1='30' y1='0' x2='30' y2='40'/%3E%3Ctext x='5' y='12' fill='%23fff' font-size='6'>123%3C/text%3E%3C/svg%3E" alt="Hybrid">
                    </div>
                    <div class="layer-info">
                        <span class="layer-name">Hybrid + Numbers</span>
                        <span class="layer-desc">Satellite with street names & house #s</span>
                    </div>
                    <span class="layer-check">
                        <i class="fas fa-check"></i>
                    </span>
                </button>
            </div>
            
            <!-- Overlay Layers -->
            <div class="layer-section">
                <span class="section-title">OVERLAYS</span>
                
                <label class="overlay-toggle">
                    <input type="checkbox" id="toggleLabels" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Street Labels</span>
                </label>
                
                <label class="overlay-toggle">
                    <input type="checkbox" id="toggleHouseNumbers" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">House Numbers</span>
                </label>
                
                <label class="overlay-toggle">
                    <input type="checkbox" id="toggleBuildings">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Building Outlines</span>
                </label>
            </div>
        </div>
    </div>
    
    <!-- ============================================ -->
    <!-- SEARCH HISTORY SIDEBAR -->
    <!-- ============================================ -->
    <aside id="historySidebar" class="history-sidebar collapsed">
        <button id="historyToggle" class="tactical-btn btn-history-toggle" title="Search History">
            <i class="fas fa-history"></i>
            <span id="historyCount" class="history-badge">0</span>
        </button>
        
        <div class="history-panel">
            <div class="panel-header">
                <span class="panel-title">
                    <i class="fas fa-clock"></i>
                    RECENT SEARCHES
                </span>
                <button id="clearHistory" class="tactical-btn btn-close btn-small" title="Clear All">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
            
            <ul id="historyList" class="history-list">
                <!-- History items dynamically inserted -->
            </ul>
            
            <div id="historyEmpty" class="history-empty">
                <i class="fas fa-search"></i>
                <span>No recent searches</span>
            </div>
        </div>
    </aside>
    
    <!-- ============================================ -->
    <!-- LOCATION INFO CARD -->
    <!-- ============================================ -->
    <div id="locationCard" class="location-card hidden">
        <div class="card-header">
            <div class="location-badge">
                <i class="fas fa-map-marker-alt"></i>
            </div>
            <div class="location-meta">
                <span id="locationType" class="location-type">ADDRESS</span>
                <span id="locationDistance" class="location-distance">--</span>
            </div>
            <button id="closeLocationCard" class="tactical-btn btn-close" title="Close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="card-body">
            <h3 id="locationTitle" class="location-title">Location Name</h3>
            <p id="locationAddress" class="location-address">Full address details</p>
            
            <div class="location-coords">
                <div class="coord-item">
                    <span class="coord-label">LAT</span>
                    <span id="locationLat" class="coord-value">--</span>
                </div>
                <div class="coord-item">
                    <span class="coord-label">LNG</span>
                    <span id="locationLng" class="coord-value">--</span>
                </div>
            </div>
        </div>
        
        <div class="card-actions">
            <button id="copyCoords" class="tactical-btn btn-action" title="Copy Coordinates">
                <i class="fas fa-copy"></i>
                <span>COPY</span>
            </button>
            <button id="openStreetViewCard" class="tactical-btn btn-action" title="Street View">
                <i class="fas fa-street-view"></i>
                <span>STREET</span>
            </button>
            <button id="openGoogleMaps" class="tactical-btn btn-action" title="Open in Google Maps">
                <i class="fas fa-external-link-alt"></i>
                <span>GOOGLE</span>
            </button>
            <button id="maxZoomBtn" class="tactical-btn btn-action" title="Maximum Zoom">
                <i class="fas fa-search-plus"></i>
                <span>MAX</span>
            </button>
        </div>
    </div>
    
    <!-- ============================================ -->
    <!-- STATUS BAR (Bottom) -->
    <!-- ============================================ -->
    <footer class="status-bar">
        <div class="status-section status-left">
            <span class="status-item">
                <i class="fas fa-crosshairs"></i>
                <span id="cursorCoords">---, ---</span>
            </span>
        </div>
        
        <div class="status-section status-center">
            <span id="mapStatus" class="status-item status-indicator online">
                <i class="fas fa-circle"></i>
                <span>READY</span>
            </span>
            <span id="providerStatus" class="status-item">
                <i class="fas fa-server"></i>
                <span>Photon</span>
            </span>
        </div>
        
        <div class="status-section status-right">
            <span class="status-item">
                <i class="fas fa-search"></i>
                <span>Zoom: <span id="zoomLevel">--</span></span>
            </span>
            <span class="status-item">
                <i class="fas fa-layer-group"></i>
                <span id="currentLayer">Streets</span>
            </span>
        </div>
    </footer>
    
    <!-- ============================================ -->
    <!-- LOADING OVERLAY -->
    <!-- ============================================ -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-logo">
                <i class="fas fa-crosshairs"></i>
            </div>
            <div class="loading-spinner"></div>
            <span class="loading-text">INITIALIZING TACTICAL MAP</span>
            <div class="loading-progress">
                <div id="loadingBar" class="progress-bar"></div>
            </div>
        </div>
    </div>
    
    <!-- ============================================ -->
    <!-- TOAST NOTIFICATION CONTAINER -->
    <!-- ============================================ -->
    <div id="toastContainer" class="toast-container"></div>
    
    <!-- ============================================ -->
    <!-- KEYBOARD SHORTCUTS MODAL -->
    <!-- ============================================ -->
    <div id="shortcutsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">
                    <i class="fas fa-keyboard"></i>
                    KEYBOARD SHORTCUTS
                </span>
                <button id="closeShortcuts" class="tactical-btn btn-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="shortcut-group">
                    <span class="shortcut-title">Navigation</span>
                    <div class="shortcut-item">
                        <kbd>/</kbd> or <kbd>S</kbd>
                        <span>Focus search</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>H</kbd>
                        <span>Go to home</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>L</kbd>
                        <span>My location</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>V</kbd>
                        <span>Toggle Street View</span>
                    </div>
                </div>
                <div class="shortcut-group">
                    <span class="shortcut-title">Map Layers</span>
                    <div class="shortcut-item">
                        <kbd>1</kbd>
                        <span>Streets view</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>2</kbd>
                        <span>Satellite view</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>3</kbd>
                        <span>Dark mode</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>4</kbd>
                        <span>Hybrid + Numbers</span>
                    </div>
                </div>
                <div class="shortcut-group">
                    <span class="shortcut-title">Controls</span>
                    <div class="shortcut-item">
                        <kbd>+</kbd> / <kbd>-</kbd>
                        <span>Zoom in/out</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>M</kbd>
                        <span>Layer menu</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>Esc</kbd>
                        <span>Close panels</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>?</kbd>
                        <span>This help</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
  
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" 
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" 
            crossorigin=""></script>
			
   <script src="script.js"></script>   
</body>
</html>